const html=$query("html"),mask=$id("mask"),navList=async()=>{var e=$query(".open_nav");if(e){const t=$id("mobile_nav");e.addEventListener("click",async()=>{t.classList.contains("open_mobile")||(t.className="open_mobile",mask.className="mask")})}},close_all=async()=>{const e=$id("local-search");e&&(e.classList.remove("search-animation-max"),e.classList.add("search-animation-min"),setTimeout(()=>{e.style.display=""},500)),mobile_nav.classList.remove("open_mobile"),mobile_nav.style.opacity="",mask.className=""},darkMode=()=>{if($id("darkBtn")){const t=$id("darkBtn");var e="true"===localStorage.getItem("isDark")||"dark"===$query("html").getAttribute("theme");html.setAttribute("theme",e?"dark":"light"),t.classList.toggle("icon-sun",e),t.classList.toggle("icon-moon",!e),t.addEventListener("click",()=>{var e="true"!==localStorage.isDark;localStorage.setItem("isDark",e),$id("body-wrap").style.transition="all .3s linear",html.setAttribute("theme",e?"dark":"light"),t.classList.toggle("icon-moon",!e),t.classList.toggle("icon-sun",e)})}},articlePage=()=>{if($id("post")){if($query(".uk-alert")){var e=new Date($id("dateTime").innerHTML),t=new Date($id("updateTime").innerHTML),e=e<t?t:e,o=getDaysDiffBetweenDates(e)||0,i=$id("thisTime"),s=$id("timeLag");switch(!0){case o<=90:i.classList.add("uk-alert-success"),s.innerText=`过时提醒:本文最后编辑于${o}天前，如存在错误，请及时反馈`;break;case 90<o&&o<=365:i.classList.add("uk-alert-warning"),s.innerText=`过时提醒:本文最后编辑于${o}天前，其中某些内容可能已经过时，请读者注意`;break;case 365<o:i.classList.add("uk-alert-danger"),s.innerText=`过时提醒:本文最后编辑于${o}天前，其中某些内容可能已经过时，请读者注意`}}if($query(".toc")){$queryAll(".toc-level-2").forEach(e=>{e.childNodes[1]&&(e.classList.add("toc-list-right"),e.addEventListener("click",()=>{e.classList.contains("toc-list-right")?(e.classList.remove("toc-list-right"),e.classList.add("toc-list-down"),$queryAll(".toc-link").forEach(e=>{$query(".toc-child").style.display="block"})):e.classList.contains("toc-list-down")&&(e.classList.remove("toc-list-down"),e.classList.add("toc-list-right"),$queryAll(".toc-child").forEach(e=>{e.style.display="none"}))}))});let e=$query(".rightside-toc .title");e.addEventListener("click",()=>{e.classList.contains("hidden-all")?($queryAll(".toc-child").forEach(e=>{e.style.display="block",e.parentNode.classList.remove("toc-list-right"),e.parentNode.classList.add("toc-list-down")}),e.classList.add("show-all"),e.classList.remove("hidden-all")):($queryAll(".toc-child").forEach(e=>{e.style.display="none",e.parentNode.classList.remove("toc-list-down"),e.parentNode.classList.add("toc-list-right")}),e.classList.remove("show-all"),e.classList.add("hidden-all"))})}var l,a,n;l=$id("post"),a=$query(".num"),n=$query(".progress"),tocScroll=()=>{var e,t,o=window.scrollY||document.documentElement.scrollTop,i=document.documentElement.clientHeight;l&&a&&(e=l.offsetTop,t=i<(t=l.clientHeight)?t-i:document.documentElement.scrollHeight-i,i=Math.round(100*((o-e)/t)),a.innerText=(o=100<i?100:i<=0?0:i)+"%",n.value=o)},window.addEventListener("scroll",throttle(tocScroll,10)),getScript("/js/imgbox.js",()=>{window.ViewImage&&ViewImage.init(".post-content img")}),(async()=>{if($config.code_block_expand&&$config.code_block_expand.enable){var t=$queryAll("figure.highlight");let s=$config.code_block_expand.height;for(let e=0;e<t.length;e++)t[e].clientHeight>s&&(t[e].style="max-height: "+s+"px",t[e].insertAdjacentHTML("beforeend",'<div class="show-btn"><i class="iconfont icon-chevron-down"></i></div>'));$queryAll(".show-btn").forEach(i=>{i.onclick=()=>{var e,t,o=i.childNodes[0];"iconfont icon-chevron-down"===o.className?(o.classList.remove("icon-chevron-down"),o.classList.add("icon-chevron-up"),i.parentNode.style=""):(o.classList.remove("icon-chevron-up"),o.classList.add("icon-chevron-down"),i.parentNode.style="max-height: "+s+"px",i.previousElementSibling.style="",scrollTop=document.documentElement.scrollTop||document.body.scrollTop,o=i.getBoundingClientRect().bottom+scrollTop,e=$config.code_block_expand.height,t=$config.code_block_expand.scrollTop,window.scrollTo(0,o-e-t))}})}})(),(async()=>{$id("post").addEventListener("click",e=>{const t=e.target;var o;t.classList.contains("copy-code")&&"TABLE"===(e=t.parentElement.nextElementSibling).tagName&&(e=e.querySelector(".code"),(o=window.getSelection()).selectAllChildren(e),navigator.clipboard?navigator.clipboard.writeText(o.toString()):document.execCommand("copy"),o.removeAllRanges(),t.innerText="COPIED",setTimeout(function(){t.innerText="COPY"},2e3))})})(),(async()=>{$id("reward")&&($id("reward-btn").onclick=()=>{$query(".shang-box").style.display="block",$id("alipay-radio").addEventListener("click",()=>{$id("alipay").style.display="block",$id("wechat").style.display="none"}),$id("wechat-radio").addEventListener("click",()=>{$id("wechat").style.display="block",$id("alipay").style.display="none"});const t=$query(".tip-button");let o=t.querySelector(".coin");o.maxMoveLoopCount=60,t.addEventListener("click",()=>{t.clicked||(t.classList.add("clicked"),setTimeout(()=>{o.sideRotationCount=90*Math.floor(5*Math.random()),o.maxFlipAngle=(Math.floor(4*Math.random())+3)*Math.PI,t.clicked=!0,o.moveLoopCount=0,i()},50))});const i=()=>{o.moveLoopCount++;var e=o.moveLoopCount/o.maxMoveLoopCount;o.angle=-o.maxFlipAngle*Math.pow(e-1,2)+o.maxFlipAngle,o.style.setProperty("--coin-y-multiplier",-11*Math.pow(2*e-1,4)+11),o.style.setProperty("--coin-x-multiplier",e),o.style.setProperty("--coin-scale-multiplier",.6*e),o.style.setProperty("--coin-rotation-multiplier",e*o.sideRotationCount),o.style.setProperty("--front-scale-multiplier",Math.max(Math.cos(o.angle),0)),o.style.setProperty("--front-y-multiplier",Math.sin(o.angle)),o.style.setProperty("--middle-scale-multiplier",Math.abs(Math.cos(o.angle),0)),o.style.setProperty("--middle-y-multiplier",Math.cos((o.angle+Math.PI/2)%Math.PI)),o.style.setProperty("--back-scale-multiplier",Math.max(Math.cos(o.angle-Math.PI),0)),o.style.setProperty("--back-y-multiplier",Math.sin(o.angle-Math.PI)),o.style.setProperty("--shine-opacity-multiplier",4*Math.sin((o.angle+Math.PI/2)%Math.PI)-3.2),o.style.setProperty("--shine-bg-multiplier",-40*(Math.cos((o.angle+Math.PI/2)%Math.PI)-.5)+"%"),o.moveLoopCount<o.maxMoveLoopCount?(o.moveLoopCount===o.maxMoveLoopCount-6&&t.classList.add("shrink-landing"),window.requestAnimationFrame(i)):(t.classList.add("coin-landed"),o.style.setProperty("opacity",0),setTimeout(()=>{t.classList.remove("clicked","shrink-landing","coin-landed"),setTimeout(()=>{o.style.setProperty("--coin-x-multiplier",0),o.style.setProperty("--coin-scale-multiplier",0),o.style.setProperty("--coin-rotation-multiplier",0),o.style.setProperty("--shine-opacity-multiplier",.4),o.style.setProperty("--shine-bg-multiplier","50%"),o.style.setProperty("opacity",1),t.clicked=!1,$query(".shang-box").style.display="none"},300)},1200))}})})(),(async()=>{getScript($config.qrcode.source_js,()=>{$id("qrcode-btn").appendChild(new AraleQRCode($config.qrcode.Data))})})()}},privacy=async()=>{$id("privacy")&&$queryAll(".privacy-toggle").forEach(e=>{e.parentNode.addEventListener("click",()=>{e.parentNode.classList.toggle("active")})})},ImgLazyLoad=(e,s)=>{$queryAll(e).forEach(e=>{new IntersectionObserver((e,i)=>{e.forEach(o=>{setTimeout(()=>{var e,t;o.isIntersecting&&(t=(e=o.target).getAttribute(s),e.setAttribute("src",t),i.disconnect())},500)})}).observe(e)})},history=async()=>{if($id("post")||$id("post-list")){if(records=JSON.parse(localStorage.getItem("aloeJunVisitHistory"))||[],$id("post")){let t=window.location.href.split("posts/")[1].split(".html")[0];records.some(e=>e.url===t)||(records.push({url:t}),localStorage.setItem("aloeJunVisitHistory",JSON.stringify(records)))}$id("post-list")&&$queryAll(".post-title a").forEach(e=>{let t=e.getAttribute("href").split("posts/")[1].split(".html")[0];records.some(e=>e.url===t)&&(e.parentNode.childNodes[0].style.display="none")})}},exeAllFn=()=>{navList(),ImgLazyLoad("body img[data-img]","data-img"),darkMode(),close_all(),articlePage(),privacy(),history()};document.addEventListener("DOMContentLoaded",exeAllFn);